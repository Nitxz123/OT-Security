# OT-Security

This real_plc.py script creates a virtual Modbus TCP PLC that simulates a water tank. It uses holding registers to represent water level, pump, and valve status. A background thread updates the water level based on pump/valve input every 2 seconds. The server runs on port 1502, allowing external Modbus clients to interact. It prints the system status in real-time for monitoring.

The plc establishes a Modbus TCP honeypot that simulates a PLC-controlled water tank system using the pymodbus library. It sets up a Modbus server on port 5020 with a holding register representing the water level, initially set to 50%. A background thread simulates realistic water tank behavior by adjusting the level between 20% and 100%, triggering a high-level alarm if it exceeds 90%, with all activity logged to a file. Another thread continuously monitors for abnormal changes in the register value; if it detects a sudden change greater than 5%—indicating a possible unauthorized write—it activates an override mode that halts the simulation and locks the water level to the attacker’s value. Additionally, the server logs every incoming client IP address and stores new ones in an attackers.txt file, providing basic intrusion tracking. This combination of process simulation, tampering detection, and logging transforms the server into a basic but functional industrial honeypot.

The second script is a realistic attack simulator that tests the honeypot’s robustness and detection capabilities. It connects to the honeypot’s Modbus server and performs multiple types of simulated attacks. These include writing random values to the water level register to mimic unauthorized tampering, sending high values to deliberately trigger alarms, rapidly sending multiple write requests to simulate a flooding or denial-of-service attack, and attempting to write to invalid registers to test how the honeypot handles malformed or out-of-bound Modbus requests. Each of these actions is logged to the same honeypot_log.txt file, creating a comprehensive picture of malicious activity from the honeypot’s perspective. Together, the honeypot and attack scripts form a complete testing environment for industrial control system (ICS) cybersecurity research and monitoring of Modbus protocol vulnerabilities.
